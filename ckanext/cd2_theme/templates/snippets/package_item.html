{#
  Displays a single dataset.

  package        - A package to display.
  item_class     - The class name to use on the list item.
  hide_resources - If true hides the resources (default: false).
  banner         - If true displays a popular banner (default: false).
  truncate       - The length to trucate the description to (default: 360)
  truncate_title - The length to truncate the title to (default: 80).

  Example:

    {% snippet 'snippets/package_item.html', package=c.datasets[0] %}

#}
  {% set truncate = truncate or 360 %}
  {% set truncate_title = truncate_title or 80 %}
  {% set title = package.title or package.name %}
  {% set notes = h.markdown_extract(package.notes, extract_length=truncate) %}

  {% block package_item %}
    <li class="{{ item_class or "dataset-item" }}">
      {% block content %}
        <div class="dataset-content">
          {% block heading %}
          <img src="{{ package.organization.image_url }}" style="width:40px; float:right">
            <h2 class="dataset-heading">
              {% block heading_private %}
              {% if package.private %}
              <span class="dataset-private label label-inverse">
                <i class="fa fa-lock"></i>
                {{ _('Private') }}
              </span>
              {% endif %}
              {% endblock %}
              {% block heading_title %}
              {{ h.link_to(h.truncate(title, truncate_title), h.url_for('%s.read' % package.type, id=package.name)) }}
              {% endblock %}
              {% block heading_meta %}
              {% if package.get('state', '').startswith('draft') %}
              <span class="label label-info">{{ _('Draft') }}</span>
              {% elif package.get('state', '').startswith('deleted') %}
              <span class="label label-danger">{{ _('Deleted') }}</span>
              {% endif %}
              {{ h.popular('recent views', package.tracking_summary.recent, min=10) if package.tracking_summary }}
              {% endblock %}
            </h2>

            <table class="table table-condensed">
            <tbody>
              <tr><td width="30%">Study:</td><td><span class="label">{{package.dc_cohort}}</span></td></tr> 
              <tr><td>Mode of collection:</td><td><span class="label">{{ package.dc_mode_of_collection }}</span>
                {% if package.dc_mode_of_collection_sub %}
                &nbsp;<i class="fa fa-chevron-right" aria-hidden="true" style="color:#777"></i>&nbsp;<span class="label">{{ package.dc_mode_of_collection_sub }}</span></td></tr>
                {% endif %}
                <tr><td>Available measurements:</td><td>
                {% for waves in package.wave %}
                  <span class="label"  data-toggle="tooltip" data-placement="bottom" title="around {{wave["waves.wave_median_age"]}} years">{{ waves.wave_title }}</span>
                {% endfor %}
              </td></tr>
              </tbody>
              </table>
          {% endblock %}
          {% block banner %}
            {% if banner %}
              <span class="banner">{{ _('Popular') }}</span>
            {% endif %}
          {% endblock %}
          {% block notes %}
            {% if notes %}
              <div class='dataset-description'>{{ notes|urlize }}</div>
            {% else %}
              <p class="empty">{{ _("This dataset has no description") }}</p>
            {% endif %}
            <span class='dataset-date'><small>
              <span class='dataset-date-created'>Created {{ h.render_datetime(package.metadata_created) }}</span>
              <span class='dataset-date-separator'>&bull;</span>
              <span class='dataset-date-updated'>Updated {{ h.render_datetime(package.metadata_modified) }}</span>
              </small>
            </span>
          {% endblock %}
        </div>
        {% block resources %}
          {% if package.resources and not hide_resources %}
            {% block resources_outer %}
              <ul class="dataset-resources list-unstyled">
                {% block resources_inner %}
                  {% for resource in h.dict_list_reduce(package.resources, 'format') %}
                  <li>
                    {% if h.check_ckan_version('2.9') %}
                      <a href="{{ h.url_for(package.type ~ '.read', id=package.name) }}#dataset-resources" class="label" data-format="{{ resource.lower() }}">{{ resource }}</a>
                    {% else %}
                      <a href="{{ h.url_for(controller='package', action='read', id=package.name) }}#dataset-resources" class="label" data-format="{{ resource.lower() }}">{{ resource }}</a>
                    {% endif %}
                  </li>
                  {% endfor %}
                {% endblock %}
              </ul>
            {% endblock %}
          {% endif %}
        {% endblock %}
      {% endblock %}
    </li>
  {% endblock %}
