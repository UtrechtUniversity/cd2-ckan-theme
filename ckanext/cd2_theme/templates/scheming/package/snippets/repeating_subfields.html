{% set fields = data[field.field_name] %}
{% set fields_passed = [] %}
{# list subfields to manually style #}
{%- set exclude_subfields = [
  'cohort_publisher',
  'wave_publisher'
  ] -%}

{% block subfield_display %}
  {% for field_data in fields %}

  {% if field.field_name in exclude_subfields %} 
    {% if field.field_name not in fields_passed %}
        {% do fields_passed.append(field.field_name) %}
        {% for subfield in fields %}
        <div class="panel panel-default">
          <div class="panel-body">
            <dl class="scheming-subfield-list">
              <dt class="dataset-label">
              </dt>
              {% if field.field_name == 'cohort_publisher' %}
              <dd><span class="tabspan fa fa-building"></span><span onmouseenter="tooltipAddElement(this,'{{ subfield.cohort_publisher_identifier_type }}',40,'info-circle')" onmouseleave="tooltipRemoveElement(this)" class="repeating-element"><a href="{{subfield.cohort_publisher_identifier}}" target="blank">{{ subfield.cohort_publisher_name }}</a></span></dd>
              {% elif field.field_name == 'wave_publisher' %}
              <dd><span class="tabspan fa fa-building"></span><span onmouseenter="tooltipAddElement(this,'{{ subfield.wave_publisher_identifier_type }}',40,'info-circle')" onmouseleave="tooltipRemoveElement(this)" class="repeating-element"><a href="{{subfield.wave_publisher_identifier}}" target="blank">{{ subfield.wave_publisher_name }}</a></span></dd>
              {% endif %}
            </dl>
          </div>
        </div>
        {% endfor %}
      {% endif %}
    {% else %}

    <div class="panel panel-default">
      <div class="panel-body">
        <dl class="scheming-subfield-list">
          {% for subfield in field.repeating_subfields %}
            <dt class="dataset-label">
              {% if h.scheming_language_text(subfield.label) == 'Creator' or  h.scheming_language_text(subfield.label) == 'Contributor' or h.scheming_language_text(subfield.label) == 'Name' %}
              {% set icon = 'fa-user'  %}
              {% elif h.scheming_language_text(subfield.label) == 'Affiliation' %}
              {% set icon = 'fa-building'  %}
              {% elif h.scheming_language_text(subfield.label) == 'Identifier' %}
              {% set icon = 'fa-info-circle'  %}
              {% elif h.scheming_language_text(subfield.label) == 'Identifier type' %}
              {% set icon = 'fa-tag'  %}
              {% elif h.scheming_language_text(subfield.label) == 'Funder name' %}
              {% set icon = 'fa-university'  %}
              {% elif h.scheming_language_text(subfield.label) == 'Grant number' %}
              {% set icon = 'fa-hashtag'  %}
              {% elif h.scheming_language_text(subfield.label) == 'Citation' %}
              {% set icon = 'fa-share-alt'  %}
              {% elif h.scheming_language_text(subfield.label) == 'Reference type' %}
              {% set icon = 'fa-hand-o-right'  %}
              {% elif h.scheming_language_text(subfield.label) == 'Publisher name' %}
              {% set icon = 'fa-building'  %}
              {% elif h.scheming_language_text(subfield.label) == 'Publisher ID' %}
              {% set icon = 'fa-info-circle'  %}
              {% elif h.scheming_language_text(subfield.label) == 'Publisher ID-type' %}
              {% set icon = 'fa-tag'  %}
              {% elif h.scheming_language_text(subfield.label) == 'Mail address' %}
              {% set icon = 'fa-envelope'  %}
              {% elif h.scheming_language_text(subfield.label) == 'URL' %}
              {% set icon = 'fa-external-link'  %}
              {% elif h.scheming_language_text(subfield.label) == 'Description' %}
              {% set icon = 'fa-question-circle'  %}
              {% else %}
              {{ h.scheming_language_text(subfield.label) }}
              {% set icon = '' %}
              {% endif %}
            </dt>
            <dd>
            <span class="tabspan fa {{ icon }}"></span> 
            <span class="repeating-element">
            {%- snippet 'scheming/snippets/display_field.html',
              field=subfield,
              data=field_data,
              entity_type=entity_type,
              object_type=object_type
            -%}
            </span>
            </dd>
          {% endfor %}
        </dl>
      </div>
    </div>
  {% endfor %}
  {% endif %}
{% endblock %}